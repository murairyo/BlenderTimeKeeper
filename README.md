# TimeKeeper - Blender作業時間計測アドオン

## 概要

TimeKeeperは、Blenderでの作業時間を自動的に計測し、トップバーに表示するアドオンです。作業時間は累積され、ファイル保存時に一緒に保存されるため、別名保存やファイル再読み込み後も作業時間が引き継がれます。

## 機能

### ✅ 実装済み機能

- **自動時間計測**: Blenderを開いている間の作業時間を自動計測
- **累積時間表示**: トップバー右端に「作業時間: HH:MM:SS」形式で表示
- **データ永続化**: ファイル保存時に作業時間を.blendファイルに保存
- **別名保存対応**: 別名保存時も作業時間が引き継がれる
- **リアルタイム更新**: 1秒ごとに表示が更新

### 🔧 技術的特徴

- **拡張性**: モジュール化された設計で、将来的な機能追加が容易
- **安定性**: エラーハンドリングと適切なリソース管理
- **柔軟性**: Blenderのイベントシステムを活用した堅牢な実装

## インストール方法

1. `time_keeper.py` ファイルをBlenderのアドオンフォルダにコピーするか、Blenderの設定からアドオンとしてインストール
2. 編集 > プリファレンス > アドオン > System > "TimeKeeper - 作業時間計測"にチェックを入れる
3. インストール完了！アドオンが有効化されると自動的に計測が開始されます

## 使用方法

### 基本操作

1. **自動開始**: アドオンが有効化されると、自動的に時間計測が開始されます
2. **時間確認**: トップバーの右端に「作業時間: 00:00:00」形式で表示されます
3. **保存**: ファイルを保存すると、作業時間も一緒に保存されます
4. **引き継ぎ**: ファイルを再度開くと、保存された作業時間から継続されます

### ファイル操作での動作

- **新規ファイル**: 00:00:00から計測開始
- **ファイル読み込み**: 保存されていた作業時間から継続
- **別名保存**: 現在の作業時間を新しいファイルに引き継ぎ
- **ファイル切り替え**: 各ファイルごとに独立した時間管理

## コードアーキテクチャ

### 主要コンポーネント

```
TimeKeeperData (PropertyGroup)
├── total_time: 累積作業時間
└── session_start_time: セッション開始時刻

TimeKeeperManager (Class)
├── start_session(): セッション開始
├── stop_session(): セッション停止
├── get_current_total_time(): 現在の累積時間取得
└── _timer_callback(): UI更新トリガー

TIMEKEEPER_PT_TopBar (Panel)
└── draw(): トップバーでの時間表示

Event Handlers
├── load_pre_handler: ファイル読み込み前
├── load_post_handler: ファイル読み込み後
└── save_pre_handler: ファイル保存前
```

### 拡張ポイント

将来的な機能追加のために、以下の拡張ポイントが設計されています：

1. **TimeKeeperData**: 新しいデータフィールドの追加
2. **TimeKeeperManager**: 追加のタイマー機能や統計機能
3. **UI**: 詳細表示パネルや設定画面の追加
4. **ハンドラー**: プロジェクト別統計や自動レポート機能

## 技術仕様

- **Blender対応バージョン**: 3.0.0以上
- **Python**: Blender内蔵のPythonを使用
- **データ保存**: .blendファイル内のカスタムプロパティとして保存
- **更新頻度**: 1秒間隔
- **メモリ使用量**: 最小限（タイマーとデータプロパティのみ）

## 注意事項

- Blenderを最小化した状態でも時間計測は継続されます
- 複数のBlenderインスタンスを開いている場合、各インスタンスで独立して計測されます
- 作業時間はBlenderファイルと一緒に保存されるため、ファイルサイズにわずかな影響があります（数バイト程度）

## 今後の拡張予定（参考）

以下の機能は拡張性を考慮して実装が容易になっています：

- プロジェクト別時間管理
- 詳細統計情報表示
- CSV/JSONエクスポート機能
- 作業時間目標設定
- 休憩時間の自動検出
- タイムライン表示

---

## ライセンス

このアドオンは拡張と改変が可能な設計になっています。 